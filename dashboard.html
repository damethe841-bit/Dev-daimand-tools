<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#f2f5f3}
.container{max-width:420px;margin:auto;padding-bottom:80px}
.header{background:#1fa463;color:#fff;padding:20px;border-radius:0 0 20px 20px}
.cards{display:flex;gap:10px;margin-top:10px}
.card{flex:1;background:#fff;padding:15px;border-radius:14px;text-align:center}
.udhar{color:#e53935}
.jama{color:#1fa463}
.actions{display:flex;gap:10px;margin:20px}
.btn{flex:1;background:#1fa463;color:#fff;padding:12px;border:none;border-radius:12px}
.list{margin:0 20px}
.item{background:#fff;padding:12px;border-radius:12px;display:flex;justify-content:space-between;margin-bottom:10px}
.empty{color:#888;text-align:center;margin-top:20px}
.nav{position:fixed;bottom:0;width:100%;max-width:420px;display:flex;background:#fff;border-top:1px solid #ddd}
.nav a{flex:1;text-align:center;padding:12px;text-decoration:none;color:#555}
.nav a.active{color:#1fa463;font-weight:bold}
</style>
</head>

<body>
<div class="container">

<div class="header">
<h2>Welcome</h2>
<p id="shopName">My Shop</p>

<div class="cards">
<div class="card">
Total Udhar
<div class="udhar" id="totalUdhar">â‚¹0</div>
</div>
<div class="card">
Total Jama
<div class="jama" id="totalJama">â‚¹0</div>
</div>
</div>
</div>

<div class="actions">
<button class="btn" onclick="goAdd()">+ Add Entry</button>
<button class="btn" onclick="resetAll()" style="background:#e53935">
Reset Data
</button>
</div>

<div class="list" id="customerList"></div>
<div class="empty" id="emptyText">No entries yet</div>

</div>

<div class="nav">
<a href="dashboard.html" class="active">Home</a>
<a href="customer.html">Customers</a>
<a href="add-entry.html">Add</a>
<a href="report.html">Report</a>
</div>

<script>
// ðŸ”¥ AUTO CLEAN OLD DEMO DATA (RUNS ONCE)
if(!localStorage.getItem("cleaned")){
  localStorage.clear();
  localStorage.setItem("cleaned","yes");
}

// SHOP NAME
document.getElementById("shopName").innerText =
localStorage.getItem("shopName") || "My Shop";

// LOAD ENTRIES
const entries = JSON.parse(localStorage.getItem("entries") || "[]");
const list = document.getElementById("customerList");
const empty = document.getElementById("emptyText");

let totalUdhar = 0;
let totalJama = 0;
const customers = {};

entries.forEach(e=>{
  if(!customers[e.customer]) customers[e.customer]=0;
  if(e.type==="Udhar"){
    customers[e.customer]-=e.amount;
    totalUdhar+=e.amount;
  }else{
    customers[e.customer]+=e.amount;
    totalJama+=e.amount;
  }
});

document.getElementById("totalUdhar").innerText="â‚¹"+totalUdhar;
document.getElementById("totalJama").innerText="â‚¹"+totalJama;

if(entries.length===0){
  empty.style.display="block";
}else{
  empty.style.display="none";
}

for(let name in customers){
  list.innerHTML+=`
  <div class="item">
    <strong>${name}</strong>
    <span class="${customers[name]<0?'udhar':'jama'}">
      â‚¹${Math.abs(customers[name])}
    </span>
  </div>`;
}

function goAdd(){
  window.location.href="add-entry.html";
}

function resetAll(){
  if(confirm("All data will be deleted. Continue?")){
    localStorage.clear();
    location.reload();
  }
}
</script>

</body>
</html>
